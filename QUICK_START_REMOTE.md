# 远程协助功能快速启动指南

## 🚀 快速启动

### 方法1：使用启动器（推荐）
```bash
python start_remote_assistance.py
```
启动器会自动检查依赖、提供图形化配置界面。

### 方法2：直接启动聊天客户端
```bash
python network_share_chat.py
```
启动后在远程控制面板中启用功能。

### 方法3：测试依赖和功能
```bash
python test_pyautogui.py
```
检查PyAutoGUI和PIL是否正常工作。

## 📋 使用步骤

### 1. 确认依赖已安装
您已经安装了PyAutoGUI 0.9.54，如果仍有警告，请运行：
```bash
python test_pyautogui.py
```

### 2. 设置共享目录
- **本地测试**：选择任意文件夹，如 `C:\temp\chat_share`
- **局域网使用**：使用网络共享路径，如 `\\server\share`

### 3. 启用远程协助功能

#### 在聊天客户端中：
1. 连接到聊天室
2. 在底部找到"远程控制"面板
3. 勾选相应选项：
   - ✅ **允许他人控制我的电脑** - 允许被远程控制
   - ✅ **自动共享屏幕** - 自动开始屏幕共享

#### 屏幕共享窗口：
1. 点击 **📺 屏幕共享** 按钮
2. 在新窗口中：
   - **开始共享** - 共享自己的屏幕
   - **开始查看** - 查看他人的屏幕
   - **允许他人控制我的屏幕** - 允许远程控制

## 🎯 功能说明

### 屏幕共享
- 实时捕获和传输屏幕内容
- 自动压缩图像减少传输量
- 支持调节帧率和质量

### 远程控制
- **鼠标控制**：移动、左键、右键、滚轮
- **键盘控制**：按键和文本输入
- **自动坐标转换**：适配不同分辨率

### 文件下载增强
- **左键点击**：下载到默认目录
- **右键点击**：选择"另存为..."指定位置

## 🔧 故障排除

### PyAutoGUI警告问题
如果显示"未安装pyautogui"警告但实际已安装：

1. **检查导入**：
   ```bash
   python -c "import pyautogui; print('PyAutoGUI版本:', pyautogui.__version__)"
   ```

2. **运行测试**：
   ```bash
   python test_pyautogui.py
   ```

3. **重新安装**：
   ```bash
   pip uninstall pyautogui
   pip install pyautogui
   ```

### 权限问题
- **Windows**：以管理员身份运行
- **macOS**：在系统偏好设置中允许辅助功能权限
- **Linux**：确保有X11显示权限

### 网络共享问题
- 确认共享目录可读写
- 检查网络连接和权限
- 尝试使用本地目录测试

## 📞 使用场景

### 1. 远程技术支持
```
用户A: 遇到问题，开启"允许他人控制"
用户B: 连接后查看屏幕，远程操作解决问题
```

### 2. 文件协作
```
用户A: 上传文件到聊天室
用户B: 右键下载链接，选择保存位置
```

### 3. 演示培训
```
讲师: 开启屏幕共享
学员: 查看讲师屏幕，实时学习操作
```

## ⚠️ 安全提醒

1. **仅在信任的环境中使用**
2. **及时关闭控制权限**
3. **定期检查共享目录权限**
4. **避免在公共网络中使用**

## 🆘 需要帮助？

1. 运行 `python start_remote_assistance.py` 使用图形化启动器
2. 查看 `REMOTE_CONTROL_README.md` 详细文档
3. 运行 `python demo_remote_control.py` 功能演示